# Initializes custom platforms
external_components:
  - source:
      type: git
      url: https://github.com/alexyao2015/ESPHomeYAML
      ref: main
    components: [ custom_ir_protocols ]
custom_ir_protocols:

remote_receiver:
  - id: ir_receiver
    pin: 
      number: ${ir_receiver_gpio}
      inverted: ${ir_receiver_inverted}
      mode: INPUT_PULLUP
    dump: all
    idle: 15ms
    on_raw:
      then:
        - homeassistant.event:
            event: esphome.${devicename}-raw-received
            data_template:
              title: !lambda |-
                return x;
    on_gicable:
      then:
        - homeassistant.event:
            event: esphome.${devicename}-gicable-received
            data:
              title: !lambda |-
                char formatted[100];
                sprintf(formatted, "Received GiCable: command=0x%04X, repeat=%d", x.command, x.repeat);
                return std::string(formatted);
    on_xmp:
      then:
        - homeassistant.event:
            event: esphome.${devicename}-xmp-received
            data:
              title: !lambda |-
                char formatted[100];
                sprintf(formatted, "Received XMP: address=0x%08X, command=0x%08X", x.address, x.command);
                return std::string(formatted);

remote_transmitter:
  pin: 
    number: ${ir_transmitter_gpio}
    inverted: ${ir_transmitter_inverted}
  carrier_duty_percent: 50%
